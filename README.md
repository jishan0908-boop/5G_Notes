# 5G_Notes
About , wireless communication and how it works 

# Chapter 1 : The 5G System
# 1.  Standardization

The motive to make the standardization of techonolgy was come , because of some difficulties , like : 1. It was tough for any one if he or she tarvel to differnt country and found differnt technologies . 2. It was expensive also that to coop-up with other country technoloy .
Because of these problems , we have to come=up with the ideas of standardization which  helps to bring the nations togethere.


## 1. Who defines what is 5G :
This moto was then intorduce by United Nation , where specifically comes under ITU(International Telecomunication Union).
ITU was established in 1865 , as the International Telegraph Union , but later on it change to  International Telecomunication Union. This agency is respondsible for the development of new telecommuntiaction technology and implementing it on all over the world.

Under ITU there are three more sub-divisions :
1. ITU-T :
   This is the ITU Telecommunication Standardization Sector , which works on Cyber-Security sector , Machine-Learning sector  and Video comprestion sector.
2. ITU-R :
   This is the ITU Radiocommunication Sector , which is the most important sector for ITU . Thids sectro is responsible for the 5G technolgy , space radio technology and wireless communticatons.
3. ITU-D :
   This is the ITU Telecommunication Development Sector , which works over to create polices , regulation , and trainuing protocals , for all over the world.
# 5G:
## IMT 2020:
International Mobile Telecommunications-2020 (IMT-2020 Standard) are the requirements issued by the ITU Radiocommunication Sector (ITU-R). This are the requirerment or we can say standards ginven by the ITU , to achive 5G.

1. Peak Data Rate(Gbits/s):
   This requirement is defined for the purpose of evaluation in the eMBB(Enhanced Mobile Broadban) usage scenario. The minimum requirements for peak data rate are as follows: â€“ Downlink peak data rate is 20 Gbit/s. â€“ Uplink peak data rate is 10 Gbit/s.

2. User Experienced Data Rate(Mbit/s):
   The target user experienced data rate for IMT-2020 5G is 100 Mbps for downlink and 50 Mbps for uplink.

3. Spcetrum Efficiency:
   5G technologies also promise to provide significant gains in spectral efficiency, enabling peak speeds that exceed 30 bits per second (bps) per Hertz (Hz).

4. Mobility(Km/h):
   This is the requirement that how fast the speed of network to work. The target is of 500Km/h .

5. Latency(ms):
   This requirement works over the delay of the packets , from one server to another . The target is to make it (million per second).

6. Connection Density:
   This requirement is deifend as  how many user can be coverd in per square kilometer , where the target is of 10 to the power 6 per square kilometer.

7. Network Energy Efficiency :
   This requirement is also important that how much energy is requied to run 5G on a moblie , where the target is 100x times.

8. Area Traffic(Mbit/s/m2):
   This requiremnet is for the network handling per meter square area.


# 2. Who actually designs 5G:

The standards are given byu ITU , but to full fill these requierment , 3GPP(3rd Generation Partnership Project) , which works to exceute 5G technology , also there is competive group present 3GPP2( 3rd Generation Partnership Project 2 ) which is developing and alter native solutions . But , in 5G 3GPP has made more succses . 

## 3GPP: 
 3rd Generation Partnership Project   , have is the organisation of several differnt countries like , Japan , United Nation of America , India  ,China , South Korea , Europe and some Private oraginsation which work together to achive these requirments.

3GPP has sub three division which works on three diffrent projects:
1. T5G RAN( Radio Access Network)
2. T5G CT(Core Network & Terminals)
3. T5G ST( Service & Systems Aspects)

## Relation between ITU & 3GPP :
Where ITU give evalution and requiremnet to 3GPP , where 3GPP start evaluations and solutions for the requirements , check the systems working and evalution and studies the requirements needed to full fill , then after complition it handed to IMT 2020 Specification where they check that , it is full filling the requirement or not.

# 2. The 5G Use Cases 
## What are the use cases that 5G is design fo ?

This quite difficult to define the feature that will sevreve use cases of 5G.

BUT  WE HAVE A 3D PYRAMIND WHICH COVERS SOME ASPECTS 
1. ENCHANCED MOBLIE BORADBAND
2. MASSIVE MACHINE TYPE COMMUNICTAIONS
3. ULTRA-RELIABLE AND LOW LATENCY COMMUNICATIONS

## ENCHANCED MOBLIE BORADBAN
This is the first use case , where it handles moblies or network traffics in bulk. The traffics of videos , where in 4G we use to use HD qualtiy videos but, In 5G we can see videos in 4K/8K quality , 3D videos or may be Virtual Reality , to watch such a videos  we need more capable network like 5G.
Things that are needed to Achive are:
1. Peak Data Rate : Where we need 20Gbps(Downloading link ) and 10Gbps(Uploading link).
2. Peak Spectrum Efficency : This is  important because to wider the broadband width more user can use it , where it needs 30 bps/Hz (Downloading link) and 15 bps/Hz ( Uploading link).
3. User experienced data rate  : It will defines the speed of the data transfer to the user 100 Mbps (Downloading link) and 50 Mbps (Uploading link).
4. Mobility : If the user is travelling with a high speed he need a fast data speed which is Up to 500 Km/h.
5. Energy Efficency : This is also one of the important aspcets becauise we cannot increase the battery size , of our moblie so we need to work , on that 5G use less energy .
6. More use cases like , in Smart Phones, Home , venues and enterprises and ( 4k / 8k videos , UHD , Broadbands etc.)
 ## MASSIVE MACHINE TYPE COMMUNICTAIONS
 This case need very little data and very less frequently , but need long battery life . This type of case we can see in smart cities where , we take and example like garbage trash cans, when they are filled a signal or data is to be trannsfer to the depeartment like a 1 bit data , which can then empty the trash cans but need longer battery so that it work for years.
Things that are needed to Achive are:
1. Density: The density here means , to cover more are of user , like 1000000 devices per sq Km2.
2. Battery: The battery life is most important aspect of this case we , need battery life  upto 10-15 years.
3. Low Data Rate: As we see the above example , we have to transfer 1 bit data or max to 100kbps.
4. More use cases like, Smart Buildings , Logistics , tracking , smart electercity meter needs ( also we need to wrok like , we these meter are in basement the data should transfer properly), Industrial application etc.

## ULTRA-RELIABLE AND LOW LATENCY COMMUNICATIONS
This case is also an important case where we need , high reliablity and low latency nearly 100% and garenty of data .Example like , self driving cars , cars should be connected to each other so that they can communicate with each other , and share 100% of data so that chnaces of accidents can be reduces.
Things that are needed to Achive are:
1. Low User Plane Latency : This need of 1 mili second . The data should be transfer very fast .
2. Low Reliablity: This should be need upto 99.9999% so that chances of accidents can be reduce.
3. Mobility Interruption Time : This is needed to 0ms .
4. More use cases like, Traffic safety , Remote manufacturing , training , surgery etc.

# THE 5G SYSTEM 
To understand how 5G system works , in video we have given an example , where there is user's smartphone which is searching somethings on google .
were their are three stages or sets, rule we can say from which they can access the google .
1. Access Network
2. Core Network
3. Data Network

## Access Network:
5G Radio Access Network , which is based on a technology called as New Radio or NR , it's responsible for providing Wwireless communication to the device.

## Core Network:
The core network in this case us 5G network , responsible for the mobility management , subscription management and secuirty management.

## Data Network:
This is simply the internet in this case.

![NETWORK WORKING](https://github.com/user-attachments/assets/76b26962-05f8-4a90-9970-30d654590661)

N2 : Here N2 , control the communication  with AMF.
N3 : Here N3 , is the Data Plane Communicate with UPF.
N4 : Here N4 , establish the communication with UPF & SMF.

The rest of the core network function communicate with each other as a microservices.

## The 5G Network can be represented in two forms:
## FIRST FORM: REFERENCE POINT REPRESENTATION
![refernce point](https://github.com/user-attachments/assets/a43134e5-961b-444b-8133-059d817dbb16)

## SECOND FROM: SERVICE BASE  REPRESENTATION

![second point](https://github.com/user-attachments/assets/686c22b7-0264-4ad9-929e-567f029bc662)

Since,  5G uses services base architecture.
We have different ends of devices using  5G network  on one end at the 5G user, Massive MTC is present , which are the large number of devices which send very little data, if these kind of devices are dominate the network then , there we have to scale control signals infrastucture . On the other hand we have Moblie Broadband devices which creates the large demands in the user plane functions because there is lot if data if , but there are only fewer devices , so these devices are dominating than we need to scale the user plane function not control plane signals . So if there is no separation in user and control plane functions , then we would end up scaling the loads handling to both user and control plane , which is inefficent way of scaling .
We separate with the demanding of user or control plane function which one is  needed to scale. Separating these , give freedom to apply differnt function in different geographical region.

## KEY NETWORK FUNCTIONS:

## 1. gNodeB : 
The main function of gNodeB , is to provide wireless connectiviy in 5G devices , in an efficent manner.

## 2. UPF :
The main function of UPF , is to provides interface towards internet . This is good place  to enforcing polcies to ensure the devices doesn't exceeds the data . Also we can call it , the mobility , anchoring point for enforcement of polices and lawful interception .
 
## 3. SMF :
Session Mangaemenet  Function , it gives the device an IP Address when the device has finshed the activity . 

## 4. AMF :
Access and Mobility Function, it forwards the sessions releated information to SMF. The primary responsiblty for supporting the devices to move between two radio cells in addition , it is responsible for the establishing the encrypted signals connection towards the devices . so that the device can be registered itself , and get authenticate , so that it is ready to accsess on internet.

## 5. AUSF :
Actual Security information Algorithms . This is the part of authentication Server function or , ASUF which support the AMF with the authencated function during the different process.

## 6. UDM :
Unified Data Management and Unified Data Repositroy . The User Subscription Data is stored in Unified Data Repository . UDM is the forntend of the user subscription data . it support AMF  in access of the Autherisation , registor management for the devices etc.

## 7. PCF :
Policy Control Function , Charging related function depending on the usage by the device.PCF provides two kind of policies support . first , the policy related to Session Management , for example , certain kind of traffices is supported or not supported their and Second policy is related to non session management they are like mobility policy example , the device may not have rights to access the network in certain geographical area.

# 5G DEPLOYMENT OPTIONs

## OPTION 1:
For the perspective of 5G & 4G , can be consider as the legacy option , first we have eNodeB which is connected to EPC( 4G Core ).
![option 1](https://github.com/user-attachments/assets/0a363dca-5000-402d-8ea8-096fe7cd145a)


## OPTION 2:
When we have 5G Radio Access Network ,connected to 5G Core network is the option 2 , it is useful for those operator who does not have the legacy of 4G netwrok.
![option 2](https://github.com/user-attachments/assets/04d02d82-5683-49dc-bb6e-e4bf5a41e914)


## OPTION 3: EN-DC ( E-UTRAN NEW RADIO - DUAL CONNECTIVIYTY )
Both 4G & 5G exist , this is when a smartphone is connected to ,two differnt techonoly , it is called Dual-Connectivity , Because it is connected to two Radio Acces Network .

In the elustration we have a smartphone which is connected to both eNodeB and gNodeB, in such a situation , one Access technology is known as Mater Radio Access Technology and other is called Secondary Radio Access Technology .

The Radio Network with provide control signaling is called Master Radio Access Technology and other which is use for data things is Secondary Radion Access Technology. We know 4G as primary and 5G as secondary and  the Core Network us the 4G Core network , The option is particularly relevant to the operator who does not have 5G Core Network . But want to use 5 Network then they has 5G RAN .

## OPTION 3 IS ALSO SUB-DIVIDED INTO THREE PARTS 3 , 3a ,3x :

## 3 :
In this option the core network is of 4G , where the data is transfer to directly to the eNodeB , and then subsituit into two part on goes to the gNodeB and other to smartphones . Here we have tri-netwrok circut of data transfer where data can be transfer to eNodeB to gNodeB or vica versa .

![3 1](https://github.com/user-attachments/assets/d828e4bb-4a79-4ecb-8e75-e674e4ecdd83)

## 3a :
In this option the core netwrok is of 4G , where in this option that data is directly transfer to the 5G RAN and there is no data transfer between , 4G and 5G RAN .This is a disadvantage because , the data cannot be share between 4G AND 5G RAN .

![3a](https://github.com/user-attachments/assets/39e57dbc-b641-4bcf-99d1-79046987a164)

## 3x :
Tn this option , it is the proper example of option 3 , which have all the same property of option 3.

![option 3](https://github.com/user-attachments/assets/a8795e80-0df1-48d0-b597-f26748a32850)


## OPTION 4 NE-DC :
In this option the Core Network is of 5G and the Master Radio Access Technology is gNodeB and Secondary Radio Access Technology is eNodeB .This option also have two sub-parts.


![option 4](https://github.com/user-attachments/assets/78afe20d-2b0b-4a5e-9d71-6d8714df750c)


## 4 :
In this option there is a tri-circut connection between gNodeB , eNodeB and smartphone . Where data can be transfer between gNodeB to eNodeB and vica versa .


![4, 1](https://github.com/user-attachments/assets/75fe6103-f34e-40e2-96ba-4dac68d1e0cf)

## 4a :
In this option there is no tri-connection , the data is directly transfer form 5G Core Netwrok to eNodeB . This is a disadvantage options , because the data is not circulate between RAN.
Also , in this case 4G access should be dirsctly connected to 5G Core Network , because of  some 5G polices , So therefore We have to update the software of 4G Base Station.


![4a](https://github.com/user-attachments/assets/23b1fb92-693b-441c-89af-f702e7bf0d2d)

## OPTION 5 eLTE:
There 4G Radio Access Technology with and enhanced version and it is directly to the 5G Core Network .

![option 5](https://github.com/user-attachments/assets/cc564405-37d6-4fb0-a79e-d1398f29b567)

## OPTION 6:
Smilarly in this option we have Core Network of 4G  and 5G Radio Access Technology . But there is some issue , However during standardization process of 5G device , they will not support this configuration , there is noway that the device can have connection to 5G gNodeB which has only access to 4G Core Network , so the option is no longer relevant.

![option 6](https://github.com/user-attachments/assets/e1985de7-d5d3-4240-8dfa-cf627fd18a5d)

## OPTION 7 NG-EN-DC :
In this option we have Core Network of 5G , where Master Radio Access Technology is 4G eLTE and Secondary Radio Access Technology is 5G gNodeB. 

![option 7](https://github.com/user-attachments/assets/feafb821-1c51-4c41-b49e-b6be29fa6cfc)

## NON STANDALONE ( NSA ) AND STANDALONE ( SA ) DEPLOYMENTS:

Where we have a sinlge technology in both Radio Access Netwrok and in Core Network , that is called as Standalone deploymenet .
Example : Option 1 and Option 2.

Where we have a combinations of 4G & 5G Technology in Radio Access Netwrok and in Core Network , that is called as Non-Standalone deployment.
Example : Option 3 , Option 4 and Option 7.

# Chapter 2 : 5G NR( NEW RADIO ): RAN ( RADIO ACCESS NETWORK ) gNodeB

## PAN Protocol Stack 
There are two RAN Protocol Stack :

1. User Plane Protocol Stack .

   The User Plane Protocol Stack supports or the arriving of the user data between different application in UE and Netwrok.
   
3. Control Plane Protocol Stack .

   The Control Plane Protocol Stack can been seen carrying control information in between UE and to gNodeB or to Core Network.
    

![Screenshot 2024-10-19 142201](https://github.com/user-attachments/assets/fd5420dd-84d2-413d-8bfc-07cc3397506f)


## User Plane Protocol Stack 

![upps](https://github.com/user-attachments/assets/bd94de7e-09fd-4c9c-981b-084005956076)


Each layer provide services to above layer and consumes the services of below layer .

Example: RLC provides services to PDCP and uses the services of MAC.

## PHY : 
PHY ( Physical ) , this is the efficent way of wireless coommunication . Here , Bits and Bytes are transimited efficently passing through Wwireless Channels.

## MAC :
MAC ( Medium Access Control ) , it provide retransmission (looking for errors) , multiplexing.demultiplexing , scheduling and also , provides fast feedbacks to error .

## RLC :
RLC ( Radio Link Control ) ,  where ARQ represents breaking up of complete data  into IP packets in small packet , this process is called Segmentation. In the transmission side and putting  them back togethere , this process is called reassembly .

## PDCP :
PDCP ( Packet Data Convergence Protocol ) , in this layer IP packets are design for user communication over a wireless communcation , so certain precautions should be taken , first the IP Header has a lot of information that is no longer necessary so Header IP is compressed . 

## SDAP :
SDAP ( Service Data Adaptation Protocol ) , it is responsible for the mapping of QoS bearer into the right radio bearer according to QoS requirement .

![1](https://github.com/user-attachments/assets/80ddbf2c-d667-451f-90a1-c064332f8dfc)

![example](https://github.com/user-attachments/assets/16889cde-e2f0-4388-8323-94baa9472c53)

## Control Plane Protocol Stack 

![cpps](https://github.com/user-attachments/assets/0445551c-d807-4a7e-9cea-ddde30b6de7e)

## NAS :
NAS ( Non-Access Stratum ) , Authentication , Security , Idel mode procedures .

## RRC : 
RRC ( Radio Resource Control ) , System information , Radio Bearer , Measuerment configuration .

# SDAP ( Service Data Adaptation Protocol ) :

5G , Supports variety of Services .

![2](https://github.com/user-attachments/assets/3205331b-5c36-407d-a490-c53be881723f)

## QoS : 
Ability to provide different priority to different application , users or data flows or to guarantee a certain level of performace

## Qos flows : QFI : 
Packets are classified and marked using an ID called QOS identifier or QFI ; using these packets with certain QFI can recieve cooresponding treatment used to differentiate package from different kinds of services

![3](https://github.com/user-attachments/assets/a6884eeb-e327-4904-8ad0-044869be73d8)

# QoS Flow are of Three types :

![4](https://github.com/user-attachments/assets/1688e4b8-e63e-4b73-a1dd-8c44467a892c)

## GBR :
GBR ( Guarenteed Bitrate ) , voice comm requires GBR so voice doesnt get disrupted.

## NGBR :
NGBR ( Non-Guarenteed Bitrate ) , browseing required NGBR , because in browseing traffices are more busty in nature .

## Delay Critical :
Delay Critical , are use for machein critical application , ex self driving robots etc.

![5](https://github.com/user-attachments/assets/078b5a47-b8cc-4919-a90a-a17a7c9ef04b)

![6](https://github.com/user-attachments/assets/0430e40d-0446-464b-b25b-946736e0a725)

![7](https://github.com/user-attachments/assets/bb53725a-2eca-4b51-b1de-c13e8b91fdad)

In the above image we can see , that the Application and Network are the one who can see the IP Addresses.
## Multiplexing :
1. When packets arrives at the UPF it maps the IP Flow into a certain QoS Flow , with a corresponding QFI , which depends upon the priorty of the application that what should get .
2. When packets arrives at the gNodeB , the SDAP  layer maps IP Address the packets with corresponding QFI to the appropiate data rate radio bearer .

![8](https://github.com/user-attachments/assets/818da98e-d626-4c78-9bc3-710d644924f4)

## Reflective Mapping :
When the device uses the same QoS Flow radio bearer in Uplink as same in Downlink , it is called reflective mapping because Uplink reflects Downlink.

## Explicit Mapping :
When the device configure to use a specfic QoS Flow and Uplink bearer through RRC signaling , then it is called Explicit mapping , because here the device is explicitly told to use certain bearer and certain QoS Flow in Uplink and reversely configured in Downlink.

![9](https://github.com/user-attachments/assets/1af742a0-6cce-4ad9-ba6f-2b56184c1a99)

# PDCP ( PACKET DATA CONVERGENCE PROTOCOL ) :

PDCP has four main function : 

![1](https://github.com/user-attachments/assets/576a990b-822d-494f-a7d1-7e477bb754da)

## 1. Header Compression   :

The Compression Header is much more smaller than the orignal IP Header . The header compression schem in NR is based on RObust Header Compression (ROHC) Protocol . This is a standardize comprasion framework that used also , for other moblie communication technology .
Example : The header compression and Dehaeder compression , therefore , they servers the purpose of reducing effective numbers of bits transmitted over the radio interface .

![2](https://github.com/user-attachments/assets/cb1c6451-6405-4506-8002-9fd747a8ca26)


## 2. Ciphering and Integrity protection :

There are two acpects of security that the PDCP do :

1. If someone is listing to the wirless channel and evasdropping there shoud not be able to decode the information transmited , so to counter this PDCP employs the Ciphering .
2. It should be possible tp verify that the data orginated from the right source for this purpose it perform Integrity protection .

## Ciphering :
So , Ciphering is the process of taking incrypted information called , clear text or plane text and encrypte it into Ciphering text using a encryption key . The key text in NR is genrated using S input and encryption algorithm called NEA -> NR encryption algorithm . the most important input is key called , Krrc,enc wich is the security key used for algorithm ,  bearer etc.

## Integrity Protection :
When it comes to IP the data is not to modifiy the information , but to add a code to denominate the source for this purpose the NR uses the simpler system using algorithm called NIA -> NR Integrity algrithm .it uses the similar of input and create a MAC authentication code which is append to the message in the input to the key genration we have the key , called Krrc,int which is the important for the Integrity protection .

![3](https://github.com/user-attachments/assets/e4773c6d-1cd4-4d8c-b11f-ce829cc0c714)


##  3. Routing and Duplication :
NR supports dual connectivity where  a mobile terminal can be simultaneously connected to , two servceing base station  eithere other NR or one NR and one LTU , in such cases the cell that is connected to the mobility management entity in the Core Network is called Master Cell and the cell that provide additional radio resouces is called the secondary cell . In order for the data to be sent over both base station is split bearer is used where the data is split into two data stream , one is transmited over to Master cell and other is to secondary cell . 

The cells in such cases if we see the split bearer it is the PDCP , that is responsible for routing the data flow through different bearer to master cell nd secondary cell groups. In addition to using dual connectivity to achive more data rate , duplication can be used to send the exact same data to through two different bearer to improve the realiblity . In this way even if one of the path gets currupt the information canm be retrive from the other data bearer . This imprpove realiblity , it input the unerrorer packets from the one of the bearer which has no error this ability to select the multiple copies is called Selection diversity and is imporve the realiblity .


![4](https://github.com/user-attachments/assets/db7ec12e-cd8e-4c6c-8919-c16040af35d2)

## 4. In-sequence vs out-of-sequence delivery :

If we see for some application like file transfering even if the packet store arrival at the excat same sequence it doesn't make . The TCP when is protocol function above the IP can takes caree of recoprding the packets is immediately forward to higher layers . 

Some Appllication like video streaming the packet has to arrive in the exact sequence to be transmited . so such casesin PDCP can be configured for the sequence delivery in such case on the transmited side the PDCP acts as a sequence number to ensure the in sequqnce delivery .

![5](https://github.com/user-attachments/assets/277a76a5-f819-4c6d-b5fc-a8fba1859e02)

![6](https://github.com/user-attachments/assets/9edc1dc2-221d-46dd-bc3d-0e0847fa792a)


# RLC RADIO LINK CONROL :

RLC ( radio link control ) has two major function :

1. Segmentation
2. ARQ-Retransmissions

RLC Modes :
Different server has doifferent rquiremnet , eg transfer of a large file error free data , where as for the other application , eg streaming series a small amount of missing packet is not a problem , therefore it operate in three different mode .

1. Transparent : RLC is completely transparent and essentially by pass . this mode is usefl for control plane broadcasting channel .
2. Unacknowleged : This mode supports segmentation but not retransmition . This mode is used when error free delivery is not require voice or IP.
3. Acknowleged : This is the main mode of operation for a downlink aashade channel and uplinkl shade channel , This mode is essentail for web browsing file transfer etc.
   
![7](https://github.com/user-attachments/assets/0de23c7d-f25c-4104-8154-22673c2dbf6b)

## Segmentation :

![9](https://github.com/user-attachments/assets/be820811-abff-482f-b552-da0d6d8e12e8)

The sequence number to identify the different packets and it is important so that the feedback is recive abpout the if the rececption is succesful it is clear  which pdu was  or was not recive successfully .

The transport block size changes at the TTA level if one or more RLC sdu  including the headers fit exactly  in to the excpexcted transport  block size  then there is no need for segmentation 

On the other hand in this example the transport block has more spaces left if it is just padded with 0s it willl lead to inefficent use of spectrum . so when the size of transport block is np  then the third segement is split into two parts , in the case of segmentation each sdu carries the same sequence number as the orignal unsegemneted sdu which is the part of the header to distinguehed whether the pdu contain the complete sdu  or the first segment of the sdu  or the last segement of sdu , there is a field in the header that is called  segementation information which communicates which is the cases is true.

Also a segmentation offset is iuncluded in all segement except the first one and ity is used to indicate  which bit of the sdu the current segement represent .
In lte the pdu also concatenated into one big pdu . to do so device should know the exact transport size .

![8](https://github.com/user-attachments/assets/f43ea3c8-5622-4aa3-a11b-ff6091ddb894)


# Retransmission :

![10](https://github.com/user-attachments/assets/958d3644-d2e8-431a-a043-bdff34d89382)

![11](https://github.com/user-attachments/assets/e7d1615c-e64a-4438-93b5-ef77134bef77)

![12](https://github.com/user-attachments/assets/ea70e95b-527a-4592-82b6-169cef8ce132)

Here pdu n+2 is forwarded to the pdcp layer without waiting for pdu n+1 .now pdu n+1 could be missing . 

Eithere it is lost due to interfernce and lower layer are handling ARQ or on the other hand lower layers failed to detect the error ,
here the ttransimition window has not chane compared to the perivour figure because none of the pdu n or higher have been acknowledeg by the reciver hence any of this pdu may still be necessary to be retransmiited and since the transmiter is not aware is the it have to be retransmited it is not updated the transmite window the reception window has not be updated because when pdu n+2 arrives pdu n+1 is still missing , so instead of updating the recipted window , it starts the timer called the reassembly timer . if the pdu n+1 is not recive before the timer expires then retransission is required and RLC takes care of the retransmission request .

Duplicate detaction is also the responsility of the RLC , so if n+1 arrives in two copies ,then one of the cpopies is discarded 

![13](https://github.com/user-attachments/assets/74c42988-494a-4b5b-830a-324ffc4adfd8)

![14](https://github.com/user-attachments/assets/d855a6d7-5124-49fa-a5ea-b5075f55f56c)


T4 
triggers the reciver  to send a control pdu containing a status report ,  indicating what are the missing pdus control pdus has the higher priorty than the data pdus  to avoid the status reports being unnecssary delyed .and the can make negative impact at the transmission dely . control packets which carries the buffer status reports has the the higher priorty .

![15](https://github.com/user-attachments/assets/27d1e76b-2f7b-44b5-b834-1a0c29474e89)

![16](https://github.com/user-attachments/assets/6c95a57d-b618-40ad-839e-494def769a15)

T6 
finally at time T6 all the transmission includeing n+5 has been successfully transmitted and has been successfully recive and acknowledgeto transmitor .Last packet n+5 contains a flag , when the last packet is arrived at the reciver end it send a feedback to the transmitoracknowleding that all the pdus are successfully recived

![17](https://github.com/user-attachments/assets/e3f23265-c4f7-4fc4-ab83-909b548812e2)

![18](https://github.com/user-attachments/assets/5cd4cdc2-cb03-4111-a275-fd45a584c87a)

# MAC ( MEDIUM ACCESS CONTROL ) LAYER :

MAC has some four main function :

1. Logical-cannel multiplexing 
2. Hybrid-ARQ retransmissions
3. Sheduling 
4. Multiplexing / Demultiplexing for CA

## Logical-cannel multiplexing
The mac layer provides services to the RLC in the form of Logical channels and mac layer uses the services form th ephyisical layer in the form of transport channel .

* A logical channel is defined by type of information it carries it is jounerly classified as a controlchannel used for the transmission of controland configuration information necessary for the operating the NRC system or as a traffic channel used for the user data . 

* The transport channel is defined by how and with what characterstics the information is transmitted over radio interface. this includes paging , broadcaste , etc.

![19](https://github.com/user-attachments/assets/bd808fc1-0fbb-4159-9112-786b308a7d22)


## Different Logical Channel:

1. PCCH : This is used for paging of the devices whose location or the cell level is not known  to the network . therefore paging mesaages must be transmitted into multiple cells.

2. BCCU :This is used for transmission of system channelinformation from the network to all the deivces in a cell . 

3. CCCH : This is used for the transmission of control information in counjunction with random access  proceses .

4. DTCH : This is uesd for transmission of user data to one end of devices . this is typically used for transmission of all the unicaste  , uplink and downlink user data , so this handles much of the data traffics .

5.DCCH :This is used for transmission of control information to one end from the devices , thischennel is uesd for individual configuration of devices , such as settings various parameters in the devices that supports the communication . 

![20](https://github.com/user-attachments/assets/3025ef66-307a-46bd-8d94-0d4730e0a6d0)


## Different Transport Channel :
they are organised into transport blocks , in each transmission time interval atmost one transport block of the dynamic size is transmitted over the Radio interface two n from a devices.

1. PCH :This is used for transmissionm of paging information from the pcch in the logical chennel. 

2. BCH : This is used for transmission of the parts of pcch system information , more specifically called the master information .

3. DL-SCH: This is main transport channel used for transmission of downlink data in NR .

4. UL-SCH: This is used for the transmission of uplink data .

5. RACH : This does not carry any transport blocks .

In addition MAC layer can also add MAC Control element like MAC CE  into the transport blocks which is transmited over the transport channel .
it is used for impact control signaling . 

## Carrier Aggregation :

![21](https://github.com/user-attachments/assets/c53d46ca-3e08-4d2f-9d87-5e6ff53f8ff6)


When we use carrier aggreation the data is transfer to the multiple cells , in such cases the MAC entity  is responsible for the distribution of data for each flow 
across the different componet carriers or cells .
In the physical layer the each cell , the physical layer processing happened independently .

## Hybrid-ARQ retransmissions :

* IT is called hybird because it supports both error correcting in channel coding and retransmission , when the error cannot be correct, specifically the error correction process is taking care in physical layer and the retransmission are handle in MAC layer . The basic machanism is based on stop and wait protocol.
that is the transmitor transmite the data unit and wait for feedback if the  recepition was sucessful . If there is no negative acknowledegment moreover then it is assume it is a sucesses and then transmit to the next data unit .if there is a negative acknowlegemnet then it retransmites the same pdu as before .however waiting for  the positive or negative feedback  will be very time consuming . 

![22](https://github.com/user-attachments/assets/0a49ff7c-0d5a-4970-81c8-ee6bdf885ae2)


* So to make things more efficent NR are uses multiple stopping wait  process in parellel so each process transmiite the data unit and waits for feedback before taking on the next data unit . 

* In 4G LTE uses Synchronous HARQ protocol , where the feedback to a certain process exactly a fixed time after it was transmitted , so in the case of LTE there isno need to expicitly say which process is a feedback is applicable for but having a precisous timing requirement is not helpful for the dynamic  sysytem that the NR supports so in NR instead of using a fix time between the transmission and feedback they are identify by the DCI channel this process is called Asynchronous HARQ Protocol.

![23](https://github.com/user-attachments/assets/d491497d-f0fb-4fae-ae7c-6ff70b1419f2)


* In NR the trasport block can get wide large so if there is an error it is infecient for the wole transport block . To solve this problem there is a new idea. large transport blocks are divided into multiple core blocks suring the channel coding process in the physical layer and each of the core block has the coresponding crc to check if there is an error in the core block , so if the recive transport block is erroreous it could be adequate to resend only the core is not effective by the error but for that we should be able to exactly identify which core block neededs to be transmitted , so we need to assign an I'D to each core block and then transmite the I'D of the core block in the feedback . To aviod the over head a banch of code blocks are grouped  ,  so when ever there is an error only the code block gropu is effective by the error and can be retransmited . 



# SCHEDULER :

The job of the scheduler is to determine which device should use time frequency and th e anteena resources  that is the main function .
Offically a scgheduler is the part of MAC layer. but we treat is different entity because it intract woth different layers for to carry out its function and also controls the different layers carryouter function .

![24](https://github.com/user-attachments/assets/f99329b6-b9fd-45ea-bb6e-fa776589a475)


## DOWNLINK SCHEDULING :

![25](https://github.com/user-attachments/assets/de405c91-4af4-49b4-915e-d354b9ea8ab5)

![26](https://github.com/user-attachments/assets/7ae4da73-2b03-489c-91d1-9e6cd128e70e)

* NR does not standardize  the exact logic to beused by the scheduler , it defines what are the supporting machnisim so the secheduler recommanded to use the channel conditions to use the buffer states etc . 

![27](https://github.com/user-attachments/assets/99d7ac39-84a6-460c-a601-1fe1a2014ebd)

* 
In NR we have carries which are upto 100 MHz band width  , so this is a large bandwidth which is difficult to monitor. so for this purpose only the part of bandwidth is monitor with control channel .

![28](https://github.com/user-attachments/assets/459f18f4-1cf3-4a99-9df0-9d92d20b0d8c)

* In addition thieir is a one more feature of scheduler is preemption 

![29](https://github.com/user-attachments/assets/c268e4ff-cf9b-49ac-9056-de744878ccd6)

![30](https://github.com/user-attachments/assets/d34a8732-2670-4a9e-a82d-56fc7aaef0b4)

## UPLINK SCHEDULING :

* It is also loacted to the gNodeB . First we need to know the characterstics of the uplink link channel .also the buffer status has to be shared with the gNodeB.
Based on this information the scheduler do the scheduling to the different devices .that we a particular devuces can transmite and what particular resources can be transmite . this scheduling in formation is known as scheduling grant .

* Based on the SRS the gNodeB can estemate the channel quality experience in uplink to the corresponding devices . there is one difference in SRS and CSI-RS , that is SRS supports only max 4 anteena ports where as CSI-RS used in downlink  supports 32 .

![32](https://github.com/user-attachments/assets/c270484c-f699-4212-aa35-f6c6f9f659fc)

![33](https://github.com/user-attachments/assets/e824328f-e106-486d-8f0a-abc602d75c8a)

# PHYSICAL LAYER :

* So far the MAC layer constructed the transport block that inclueds both the data and control element , so know the job of the physical layer is to transmit the transport block to the wireless channel as efficently as possible , the physical layer does this by function like codeing modulation , multi-anteena processing and by mapping the signals to the apporpaite time and frequency resources .

![1](https://github.com/user-attachments/assets/193e972e-86bc-487d-9ba5-5fef1a471c1b)

1. PBCH : This is used by devices to access the network.
2. PDSCH : This the main channel for the data transmission , to the devices paging in information and data transfer .
3. PDCCH : This is used for downlink control information .
4. PUSCH : This is the main channel for data transmisstion form the device side.
5. PUCCH : This is used by devices for Hybird ARQ acknowledegemnts indicating whether the data is reacive at the trasnport block sucessfully or not .
6. PRACH : This is used for the random access processor 

-DCI (downlink control information) : provides device with neccessary information for proper decoding and reception of downlink data UCI : provides the scheduler with informatipn about the situation at the device

* requests retransmission if transport block is fully corrupted
* crc length : 24 bits when payload > 3824 bit and 16 bits when < 38
![2](https://github.com/user-attachments/assets/8ad3b474-0950-4f76-9e2d-a2b29b8de474)
## LDPC :
It uses a parameter called base graph ,that governce the coding processes , NR supports two ldpc base graph 
1. For small transport blocks.
2. For large transport blocks .
![3](https://github.com/user-attachments/assets/15f71aab-4605-4e04-a7ff-f29084a0f1cc)

## CODE BLOCK SEGMENTATION:
So  , if the transport block is bigger than to this limit it has to be segmented into smaller blocks called code blocks.
![4](https://github.com/user-attachments/assets/c576a05b-0a84-46d9-9ebc-fb3d513397cb)

## LDPC CODING :
LDPC coding helps in error correction , it is a proccess of adding additional bits , that improves the resiliency of the channel.
![5](https://github.com/user-attachments/assets/4bc91c88-93c8-4fba-a7cb-54685fad7582)

## RATE MATCHING :
So after the ldpc coding process , rate matching takes the coded bits extract the exact set of bits that to be transmitted.
![6](https://github.com/user-attachments/assets/d6d17d20-7fc2-4e2c-9fd5-f87b6adce3e5)

## SCRAMBLING :
![7](https://github.com/user-attachments/assets/aa172114-8004-4158-8678-8b0a4daee71b)

## MODULATION :
![8](https://github.com/user-attachments/assets/4f29978e-e21b-4d22-b8ec-9571a1591192)

## LAYER MAPPING :
![9](https://github.com/user-attachments/assets/ba4521aa-9768-49de-9a10-01b53e623d89)





